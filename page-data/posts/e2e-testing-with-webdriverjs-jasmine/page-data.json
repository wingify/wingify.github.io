{"componentChunkName":"component---src-templates-post-js","path":"/posts/e2e-testing-with-webdriverjs-jasmine/","result":{"data":{"markdownRemark":{"html":"<p>e2e or end-to-end or UI testing is a methodology used to test whether the flow of an application is performing as designed from start to finish. In simple words, it is testing of your application from the user endpoint where the whole system is a blackbox with only the UI exposed to the user.</p>\n<p>It can become quite an overhead if done manually and if your application has a large number of interactions/pages to test.</p>\n<p>In the rest of the article I'll talk about webdriverJS and Jasmine to automate your e2e testing, a combination which isn't talked about much on the web.</p>\n<h2 id=\"what-is-webdriverjs\" style=\"position:relative;\"><a href=\"#what-is-webdriverjs\" aria-label=\"what is webdriverjs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>What is WebDriverJS?</h2>\n<p>This was something which took me quite sometime to put my head around and I feel this was more or less due to the various available options for everything related to WebDriver.</p>\n<p>So let's take it from the top and see what its all about.</p>\n<h3 id=\"selenium\" style=\"position:relative;\"><a href=\"#selenium\" aria-label=\"selenium permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Selenium</h3>\n<p>As mentioned on the <a href=\"http://www.seleniumhq.org/\">selenium website</a>, Selenium automates browsers. That's it.</p>\n<p>This having support for almost all major browsers, is a very good alternative to automate our tests in the browser.\nSo whatever you do in the browser while testing your application, like navigating to pages, clicking a button, writing text in input boxes, submitting forms etc, can be automated using Selenium.</p>\n<h3 id=\"webdriver\" style=\"position:relative;\"><a href=\"#webdriver\" aria-label=\"webdriver permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WebDriver</h3>\n<p>WebDriver (or Selenium 2) basically refers to the language bindings and the implementations of the individual browser controlling code.</p>\n<p>WebDriver introduces a <a href=\"https://code.google.com/p/selenium/wiki/JsonWireProtocol\">JSON wire protocol</a> for various language bindings to communicate with the browser controller.</p>\n<p>For example, to click an element in the browser, the binding will send POST request on <code class=\"language-text\">/session/:sessionId/element/:id/click</code></p>\n<p>So, at one end there is the language binding and a server, known as Selenium server, on the other. Both communicate using the JSON wire protocol.</p>\n<h3 id=\"webdriverjs\" style=\"position:relative;\"><a href=\"#webdriverjs\" aria-label=\"webdriverjs permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>WebDriverJS</h3>\n<p>As mentioned, WebDriver has a number of bindings for various languages like Ruby, Python etc. JavaScript being the language of choice for the web, is the latest one to make it to the list. Enter <a href=\"https://code.google.com/p/selenium/wiki/WebDriverJs\">WebDriverJS</a>!</p>\n<p>So as you might guess, WebDriverJS is simply a wrapper over the JSON wire protocol exposing high level functions to make our life easy.</p>\n<p>Now if you search <strong>webdriver JS</strong> on the web, you'll come across 2 different bindings namely <a href=\"https://code.google.com/p/selenium/wiki/WebDriverJs\"><em>selenium-webdriver</em></a> and <a href=\"https://github.com/camme/webdriverjs\"><em>webdriverjs</em></a> (yeah, lots of driver), both available as node modules. You can use anyone you like, though we'll stick to the official one i.e. <em>selenium-webdriver</em>.</p>\n<p>Say you have a JavaScript project you want to automate e2e testing on. Installing the bindings is as simple as doing:</p>\n<p>{% highlight bash %}\nnpm install selenium-webdriver\n{% endhighlight %}</p>\n<p>Done! You can now require the package and with a lil' configuration you can open any webpage in the browser:</p>\n<p>{% highlight javascript %}\nvar webdriver = require('selenium-webdriver');</p>\n<p>var driver = new webdriver.Builder().\nwithCapabilities(webdriver.Capabilities.chrome()).\nbuild();</p>\n<p>driver.get('<a href=\"http://www.wingify.com&#x27;\">http://www.wingify.com'</a>);\n{% endhighlight %}</p>\n<p>To run your test file, all you do is:</p>\n<p>{% highlight bash %}\nnode testfile.js\n{% endhighlight %}</p>\n<p><strong>Note</strong>: In addition to the npm package, you will need to download the WebDriver implementations you wish to utilize. As of 2.34.0, selenium-webdriver natively supports the <a href=\"https://code.google.com/p/selenium/wiki/ChromeDriver\">ChromeDriver</a>. Simply <a href=\"http://chromedriver.storage.googleapis.com/index.html\">download a copy</a> and make sure it can be found on your PATH. The other drivers (e.g. Firefox, Internet Explorer, and Safari), still require the <a href=\"http://selenium.googlecode.com/files/selenium-server-standalone-2.37.0.jar\">standalone Selenium server</a>.</p>\n<h3 id=\"difference-from-other-language-bindings\" style=\"position:relative;\"><a href=\"#difference-from-other-language-bindings\" aria-label=\"difference from other language bindings permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Difference from other language bindings</h3>\n<p>WebDriverJS has an important difference from other bindings in any other language - <strong>It is asynchronous</strong>.</p>\n<p>So if you had done the following in python:\n{% highlight javascript %}\n// pseudo code\ndriver.get(page1);\ndriver.click(E1);\n{% endhighlight %}</p>\n<p>Both statements would have executed synchronously as the Python (as every other language) API is blocking. But that isn't the case with JavaScript. To maintain the required sequence between various actions, WebDriverJS uses <a href=\"https://code.google.com/p/selenium/source/browse/javascript/webdriver/promise.js\">Promises</a>. In short, a promise is an object that can execute whatever you give it after it has finished.</p>\n<p>But it doesn't stop here. Even with promises, the above code would have become:</p>\n<p>{% highlight javascript %}\n// pseudo code\ndriver.get(page1).then(function () {\ndriver.click(E1);\n});\n{% endhighlight %}</p>\n<p>Do you smell callback hell in there? To make it more neat, WebDriverJS has a wrapper for Promise called as <a href=\"https://code.google.com/p/selenium/wiki/WebDriverJs#Control_Flows\"><strong>ControlFlow</strong></a>.</p>\n<p>In simple words, this is how <em>ControlFlow</em> prevents callback hell:</p>\n<ul>\n<li>It maintains a list of schedule actions.</li>\n<li>The exposed functions in WebDriverJS do not actually do their stuff, instead they just push the required action into the above mentioned list.</li>\n<li><em>ControlFlow</em> puts every new entry in the <code class=\"language-text\">then</code> callback of the last entry of the list, thus ensuring the sequence between them.</li>\n</ul>\n<p>And so, it enables us to simply do:</p>\n<p>{% highlight javascript %}\n// pseudo code\ndriver.get(page1);\n// Implicitly add to previous action's then()\ndriver.click(E1);\n{% endhighlight %}</p>\n<p>Isn't that awesome!</p>\n<p><em>Controlflow</em> also provides an <code class=\"language-text\">execute</code> function to push your custom function inside the execution list and the return value of that function is used to resolve/reject that particular execution. So you can use promises and do any asynchronous thing in your custom code:</p>\n<p>{% highlight javascript %}\nvar flow = webdriver.promise.controlFlow();</p>\n<p>flow.execute(function () {\nvar d = webdriver.promise.defer();\ndo<em>anything</em>async().then(function (val) {\nd.fulfill(val);\n})\nreturn d.promise;\n});\n{% endhighlight %}</p>\n<p><strong>Quick tip</strong>: Documentation for JavaScript bindings isn't that readily available (atleast I couldn't find it), so the best thing I found to be useful was the actual <a href=\"https://code.google.com/p/selenium/source/browse/javascript/webdriver/\">WebDriverJS code</a>. It heavily commented and is very handy while looking for specific methods on the driver.</p>\n<h2 id=\"combining-webdriverjs-with-jasmine\" style=\"position:relative;\"><a href=\"#combining-webdriverjs-with-jasmine\" aria-label=\"combining webdriverjs with jasmine permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Combining WebDriverJS with Jasmine</h2>\n<p>Our browser automation is setup with selenium. Now we need a testing framework to handle our tests. That is where <a href=\"http://pivotal.github.io/jasmine/\">Jasmine</a> comes in.</p>\n<p>You can install jasmine for your JavaScript project through npm:\n{% highlight bash %}\nnpm install jasmine-node\n{% endhighlight %}</p>\n<p>If we were to convert our earlier <code class=\"language-text\">testfile.js</code> to check for correct page title, here is what it might look like:</p>\n<p>{% highlight javascript %}\nvar webdriver = require('selenium-webdriver');</p>\n<p>var driver = new webdriver.Builder().\nwithCapabilities(webdriver.Capabilities.chrome()).\nbuild();</p>\n<p>describe('basic test', function () {\nit('should be on correct page', function () {\ndriver.get('<a href=\"http://www.wingify.com&#x27;\">http://www.wingify.com'</a>);\ndriver.getTitle().then(function(title) {\nexpect(title).toBe('Wingify');\n});\n});\n});\n{% endhighlight %}</p>\n<p>Now the above file needs to be run with <a href=\"https://github.com/mhevery/jasmine-node\">jasmine-node</a>, like so:</p>\n<p>{% highlight bash %}\njasmine-node testfile.js\n{% endhighlight %}</p>\n<p>This will fire the browser and do the mentioned operations, but you'll notice that Jasmine won't give any results for the test. Why?</p>\n<p>Well...that happens because Jasmine has finished executing and no <code class=\"language-text\">expect</code> statement ever executed because of the expectation being inside an asynchronous callback of <code class=\"language-text\">getTitle</code> function.</p>\n<p>To solve such asynchronicity in our tests, jasmine-node provides a way to tell that a particular <code class=\"language-text\">it</code> block is asynchronous. It is done by accepting a done callback in the specification (<code class=\"language-text\">it</code> function) which makes Jasmine wait for the <code class=\"language-text\">done()</code> to be executed. So here is how we fix the above code:</p>\n<p>{% highlight javascript %}\nvar webdriver = require('selenium-webdriver');</p>\n<p>var driver = new webdriver.Builder().\nwithCapabilities(webdriver.Capabilities.chrome()).\nbuild();</p>\n<p>describe('basic test', function () {\nit('should be on correct page', function (done) {\ndriver.get('<a href=\"http://www.wingify.com&#x27;\">http://www.wingify.com'</a>);\ndriver.getTitle().then(function(title) {\nexpect(title).toBe('Wingify');\n// Jasmine waits for the done callback to be called before proceeding to next specification.\ndone();\n});\n});\n});\n{% endhighlight %}</p>\n<p><strong>Quick tip</strong>: You might want to tweak the time allowed for tests to complete in Jasmine like so:</p>\n<p>{% highlight javascript %}\njasmine.getEnv().defaultTimeoutInterval = 10000; // in microseconds.\n{% endhighlight %}</p>\n<h2 id=\"bonus-for-angular-apps\" style=\"position:relative;\"><a href=\"#bonus-for-angular-apps\" aria-label=\"bonus for angular apps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Bonus for Angular apps</h2>\n<p>Angular framework has been very testing focused since the very beginning. Needless to say, they have devoted a lot of time on e2e testing as well.</p>\n<p><a href=\"https://github.com/angular/protractor\">Protractor</a> is a library by the Angular team which is a wrapper on WebDriverJS and Jasmine and is specifically tailored to make testing of Angular apps a breeze.</p>\n<p>Checkout some of the neat addons it gives you:</p>\n<ol>\n<li>Apart from querying element based on id, css selector, xpath etc, it lets you query on basis of binding, model, repeater etc. Sweet!</li>\n<li>It has Jasmine's <code class=\"language-text\">expect</code> function patched to accept promises. So, for example, in our previous test where we were checking for title:</li>\n</ol>\n<p>{% highlight javascript %}\ndriver.getTitle().then(function (title) {\nexpect(title).toBe('Wingify');\n});\n{% endhighlight %}</p>\n<p>can be refactored to a much cleaner:</p>\n<p>{% highlight javascript %}\nexpect(driver.getTitle()).toBe('Wingify');\n{% endhighlight %}</p>\n<p>And more such cool stuff to make end-to-end testing for Angular apps super-easy.</p>\n<h2 id=\"in-the-end\" style=\"position:relative;\"><a href=\"#in-the-end\" aria-label=\"in the end permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>In the end</h2>\n<p>e2e testing is important for the apps being written today and hence it becomes important for it to be automated and at the same time fun and easy to perform. There are numerous tools available for you to choose and this article talks about one such tool combination.</p>\n<p>Hope this helps you get started. So what are you waiting for, lets write some end-to-end tests!</p>\n<p>Using an e2e testing stack you want to share? Let us know in the comments.</p>\n<h2 id=\"links--references\" style=\"position:relative;\"><a href=\"#links--references\" aria-label=\"links  references permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Links &#x26; references</h2>\n<ul>\n<li>WebDriverJS user guide: <a href=\"https://code.google.com/p/selenium/wiki/WebDriverJs\">https://code.google.com/p/selenium/wiki/WebDriverJs</a></li>\n<li>WebDriverJS source: <a href=\"https://code.google.com/p/selenium/source/browse/javascript/webdriver/\">https://code.google.com/p/selenium/source/browse/javascript/webdriver/</a></li>\n<li>JSON wire protocol: <a href=\"https://code.google.com/p/selenium/wiki/JsonWireProtocol\">https://code.google.com/p/selenium/wiki/JsonWireProtocol</a></li>\n<li>Jasmine: <a href=\"http://pivotal.github.io/jasmine/\">http://pivotal.github.io/jasmine/</a></li>\n<li>jasmine-node: <a href=\"https://github.com/mhevery/jasmine-node\">https://github.com/mhevery/jasmine-node</a></li>\n<li>Protractor: <a href=\"https://github.com/angular/protractor\">https://github.com/angular/protractor</a></li>\n</ul>","timeToRead":8,"excerpt":"e2e or end-to-end or UI testing is a methodology used to test whether the flow of an application is performing as designed from start to…","frontmatter":{"title":"Automated e2e testing- WebDriverJS, Jasmine and Protractor","author":"Kushagra Gour","authorslug":"kushagra_gour"},"fields":{"slug":"/posts/e2e-testing-with-webdriverjs-jasmine/","date":"November 25, 2013"}}},"pageContext":{"slug":"/posts/e2e-testing-with-webdriverjs-jasmine/","date":"2013-11-25T18:30:00.000Z","nexttitle":"Scaling with Queues","nextslug":"/posts/scaling-with-queues/","prevtitle":"Fast Storage with RocksDB","prevslug":"/posts/fast-storage-with-rocksdb/"}}}